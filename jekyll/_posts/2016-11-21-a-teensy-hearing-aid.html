---
layout: post
title: A Teensy Hearing Aid
author: Chip
image: https://1.bp.blogspot.com/-AkdUkf4qd4A/WCW54nsreqI/AAAAAAAAD_0/LK3e_UX_Y6cfqqrcJU9avl0vDeXXXYTTQCK4B/s400/TeensyHearingAidLead2.png
---


Hearing aids are totally closed devices -- their inner workings are hidden. &nbsp;Access is limited to only those who work for the hearing aid companies. &nbsp;But if innovation is to accelerate, we need more ideas iterated more quickly. &nbsp;We need more people to participate in hearing aid development. &nbsp;But if the devices are closed, there is no way to try new ideas. &nbsp;So, let's consider the alternative. &nbsp;Let's try to build an open-source hearing aid. &nbsp;Yes, at first, an open-source hearing aid will be absurdly big and ugly. &nbsp;But, you have to start somewhere.&nbsp; I'm going to start here: take one Teensy microcontroller, add some supporting electronics, and VOILA!&nbsp;A Teensy Hearing Aid!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-AkdUkf4qd4A/WCW54nsreqI/AAAAAAAAD_0/LK3e_UX_Y6cfqqrcJU9avl0vDeXXXYTTQCK4B/s1600/TeensyHearingAidLead2.png" imageanchor="1"><img border="0" height="263" src="https://1.bp.blogspot.com/-AkdUkf4qd4A/WCW54nsreqI/AAAAAAAAD_0/LK3e_UX_Y6cfqqrcJU9avl0vDeXXXYTTQCK4B/s400/TeensyHearingAidLead2.png" width="400" /></a></div><br /><u>Basic Hearing Aid Elements:</u>&nbsp; While it is unfortunate that they are closed devices, real hearing aids are absolutely amazing pieces of technology. &nbsp;Their minuscule packages are absolutely stuffed with functionality. &nbsp;I, though, am going to start more simply.&nbsp; I will start with some microphones, analog and digital converts, a digital audio processor, some speakers, and a battery. &nbsp;Once this works, I can always add more features later.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-c4nVf-bP3sA/WC2hcAhbDZI/AAAAAAAAEA4/qGwcNiv_lRACACAp46I433WUodL2jWMyACK4B/s1600/Elements%2Bof%2BTeensyHearingAid.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="288" src="https://3.bp.blogspot.com/-c4nVf-bP3sA/WC2hcAhbDZI/AAAAAAAAEA4/qGwcNiv_lRACACAp46I433WUodL2jWMyACK4B/s640/Elements%2Bof%2BTeensyHearingAid.png" width="480" /></a></div><br /><u>Choosing a Processor</u>:&nbsp; For me, the biggest challenge is always with the software. &nbsp;Therefore, I need to choose a digital audio processor that it is easy to program.&nbsp; For me, that means choosing a processor that can be programmed from the hobbyist-friendly <a href="https://www.arduino.cc/en/Main/Software">Arduino programming environment</a>.&nbsp; Within that universe of processors, I've chosen to use the <a href="https://www.pjrc.com/store/teensy36.html">Teensy 3.6</a> because <a href="https://openaudio.blogspot.com/2016/10/benchmarking-teensy-36-is-fast.html">it's fast</a> and because it has a nice <a href="https://openaudio.blogspot.com/2016/10/teensy-audio-board-first-audio.html">audio processing library</a>&nbsp;to make it even easier to program for audio.<br /><br /><u>Supporting Elements:</u>&nbsp; To get audio signals into and out of the processor, the Teensy folks offer an inexpensive <a href="https://www.pjrc.com/store/teensy3_audio.html">Audio Adapter Board</a> that mates directly to the Teensy 3.6.&nbsp; It has the audio ADC and DAC that I need.&nbsp; For the microphones, I'm using a pair of <a href="https://www.adafruit.com/products/2716">mic breakout&nbsp;boards</a> from Adafruit.&nbsp; For speakers, I'm using whatever headphones or earbuds that I might have on-hand. &nbsp;Finally, for the battery, I'm using a&nbsp;<a href="https://www.adafruit.com/products/2750">Li-Po&nbsp;battery</a>&nbsp;and <a href="https://www.adafruit.com/products/2124">Li-Po charger</a>&nbsp;from Adafruit. <br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-T75da13q_gY/WCjOUxMGKCI/AAAAAAAAEAo/VG5UlUogkvEqQd9GrE7UPF2bXqGaJnAbgCK4B/s1600/Components.png" imageanchor="1"><img border="0" height="271" src="https://4.bp.blogspot.com/-T75da13q_gY/WCjOUxMGKCI/AAAAAAAAEAo/VG5UlUogkvEqQd9GrE7UPF2bXqGaJnAbgCK4B/s400/Components.png" width="400" /></a></div><br /><u>Wiring It Up:</u>&nbsp; The figure above gives an overview of how everything was connected together. &nbsp;As you can see, the Audio Board is at the center with everything else connecting to it.&nbsp; The only tricky part of this setup is connecting the battery and charger into the Teensy system.&nbsp; As indicated on the <a href="https://www.pjrc.com/teensy/pinout.html">Teensy pinout diagram</a>, you have to cut a trace on the backside of the Teensy so that you can insert the battery connections.&nbsp; Once cut, the Teensy's 5V USB voltage goes to the battery charger and the battery's output goes back to the Teensy's "5V" input pin.&nbsp; Not too bad. <br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Tjw_SKEm2KI/WCeAvqBb06I/AAAAAAAAEAQ/lBdymX5cToUpCM1rDix914QfWwuh_IOjwCK4B/s1600/Plexiboard.png" imageanchor="1"><img border="0" height="265" src="https://3.bp.blogspot.com/-Tjw_SKEm2KI/WCeAvqBb06I/AAAAAAAAEAQ/lBdymX5cToUpCM1rDix914QfWwuh_IOjwCK4B/s400/Plexiboard.png" width="400" /></a></div><br /><u>Initial Software:</u>&nbsp; While this post is primarily about the hardware, I did write some basic software in order to see if the hardware is working (see <a href="https://github.com/chipaudette/OpenAudio_blog/tree/master/2016-11-20%20Basic%20Hearing%20Aid/BasicGain">my GitHub repo</a>).&nbsp; I used the <a href="http://www.pjrc.com/teensy/td_libs_Audio.html">Teensy Audio Library</a> to configure the Audio Board to pass the "I2S" inputs (ie, my microphones) to the "I2S" outputs (ie, my headphones). &nbsp;In between, I wrote a simple routine that applies a user-controllable amount of gain to make things louder. &nbsp;I use the blue potentiometer on the Audio Board to set the amount of gain.<br /><br /><u>First Audio:</u>&nbsp; Of course, the first time that I tried to compile the code, my software didn't work. &nbsp;Does anyone's code ever work the first time? &nbsp;After some iteration, I finally got it to compile and upload. &nbsp;Putting on my headphones, I could hear the audio being picked up by the microphones. &nbsp;Turning the blue pot, I could control its volume. &nbsp;Hardware knobs are so satisfying. &nbsp;My favorite part, though, is being able to use the on-board battery so that I can move around freely. &nbsp;Very fun.<br /><br /><div class="separator" style="clear: both; text-align: center;"><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/zAM0sp5hG4A" width="560"></iframe></div><br /><u>Limitations:</u>&nbsp; Sure, my home-brewed "hearing aid" is ridiculously large -- no one (including me) would ever wear this around in everyday life. &nbsp;But, unlike commercially-available hearing aids, my device is open. &nbsp;Anyone can modify it to make it better. &nbsp;Anyone can try out their own audio processing algorithms to try to improve one's hearing. &nbsp;Will any of us beat the professional hearing aid algorithm designers? &nbsp;Probably not. &nbsp;But, for me at least, I will surely learn a lot by trying a few of the standard approaches. &nbsp;And, I'll get to look really cool sharing pictures of myself with this (not so) Teensy Hearing Aid. &nbsp;Happy hacking!<br /><br /><u>Follow-Up:</u>&nbsp; I measured the power consumption of my Teensy Hearing Aid. &nbsp;Using the "WFI" command, I found a super-easy way to increase the battery life by 50%. &nbsp;Wow! &nbsp;See my post <a href="http://openaudio.blogspot.com/2016/11/reducing-current-draw.html">here</a>.<br /><br /><u>Follow-Up:</u>&nbsp; I measured how the volume control affects the headphone ouput. &nbsp;See <a href="http://openaudio.blogspot.com/2016/11/teensy-audio-board-headphone-level.html">here</a>.
